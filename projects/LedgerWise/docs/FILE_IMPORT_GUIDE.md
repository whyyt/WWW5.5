# 文件导入功能使用指南

## 📥 功能概述

文件导入功能允许您批量导入账单数据，支持以下文件格式：
- **CSV/Excel** (.csv, .xlsx, .xls) - 结构化数据
- **图片** (.jpg, .jpeg, .png) - 批量账单图片识别
- **PDF** (.pdf) - PDF 格式账单识别

## 🚀 使用方法

### 1. 找到导入按钮

在 Dashboard 页面的 **AI Quick Add** 区域，您可以看到两个按钮：
- **Add Receipt** - 单张图片上传
- **Import File** - 文件批量导入 ⭐

### 2. 选择文件

点击 **Import File** 按钮，选择您要导入的文件：
- CSV/Excel：只能选择一个文件
- 图片：可以同时选择多张图片
- PDF：只能选择一个文件

### 3. 预览和编辑

系统会自动解析文件，并显示预览表格。您可以：
- ✏️ 编辑每条记录的字段（日期、金额、类别、描述、类型）
- 🗑️ 删除错误的记录
- 📊 查看统计信息（收入/支出条数）

### 4. 确认导入

确认无误后，点击 **"确认导入"** 按钮。系统会：
1. 加密每条数据
2. 上传到 IPFS
3. 写入区块链索引
4. 保存到本地存储

## 📄 CSV/Excel 文件格式

### 固定列格式（支持中英文）

| 日期 | 金额 | 类别 | 描述 | 类型 |
|------|------|------|------|------|
| 2024-01-15 | 50.00 | Food | 午餐 | 支出 |
| 2024-01-16 | 30.00 | Transport | 打车 | 支出 |
| 2024-01-18 | 2000.00 | Other | 工资 | 收入 |

### 列说明

- **日期** (必需) - 支持格式：YYYY-MM-DD, MM/DD/YYYY 等
- **金额** (必需) - 数字，自动忽略货币符号
- **类别** - Food, Transport, Shopping, Entertainment, Rent & Bills, Investments, Other
- **描述** - 交易描述
- **类型** - 收入/支出 (income/expense)

### 支持的列名（英文）

- Date / 日期 / 时间
- Amount / 金额 / 数额
- Category / 类别 / 分类
- Description / 描述 / 备注 / Memo
- Type / 类型 / 收支

### 下载模板

您可以下载示例模板开始使用：
👉 `/public/import-template.csv`

## 🖼️ 图片批量导入

### 支持的图片格式
- JPG/JPEG
- PNG
- GIF

### 使用技巧
1. 确保账单图片清晰可读
2. 每张图片包含一个独立的账单
3. 图片不宜过大（建议 < 5MB）
4. 可一次选择多张图片

### AI 识别内容
- 金额
- 日期
- 商家名称（作为描述）
- 消费类别（自动推断）

## 📋 PDF 导入

### 支持的 PDF 类型
- ✅ 文本型 PDF（可复制文字）
- ❌ 扫描件 PDF（纯图片，暂不支持）

### 识别逻辑
系统使用 AI 从 PDF 文本中提取：
- 日期
- 金额
- 类别
- 描述

**AI 服务**:
- 优先使用 Qwen API（成本更低，速度更快）
- 失败时自动切换到 Claude API
- 与图片识别使用相同的 fallback 机制

## ⚠️ 注意事项

### 数据安全
- 所有导入的数据都会自动加密
- 加密后上传到 IPFS
- CID 写入区块链，确保可追溯

### 性能建议
- CSV/Excel：建议单次导入不超过 500 条记录
- 图片：建议单次不超过 20 张
- PDF：建议文件大小 < 10MB

### 错误处理
- 如果部分数据解析失败，系统会跳过并继续处理
- 在预览阶段可以删除错误数据
- 导入完成后会显示成功/失败统计

## 🔧 常见问题

### Q1: CSV 文件无法识别？
**A:** 确保文件包含标题行，且至少有"日期"和"金额"两列。

### Q2: 图片识别不准确？
**A:** 确保图片清晰、光线充足。识别后可在预览中手动修正。

### Q3: PDF 无法解析？
**A:** 可能是扫描件 PDF。建议使用文本型 PDF 或转换为图片后导入。

### Q4: 导入速度慢？
**A:** 批量导入需要加密和上传到 IPFS，较大数据量会需要一些时间。请耐心等待。

### Q5: 类别映射规则？
**A:** 系统支持中英文类别名称自动映射：
- 食物/餐饮/吃饭 → Food
- 交通/出行 → Transport
- 购物 → Shopping
- 娱乐 → Entertainment
- 房租/账单 → Rent & Bills
- 投资/理财 → Investments

## 📞 技术支持

如有问题，请查看项目文档或提交 Issue。


